# Fibral Core Mutation Analysis — Dannenhoffer-Lafage AI/ML Lab

## Overview

This project analyzes amyloid protein fibral cores to observe mutation prediction scores generated by Envision AI. The goal is to explore how specific amino acid substitutions may affect fibral core stability, which is relevant to aging related neurodegenerative diseases such as Alzheimer’s.

The workflow automates the retrieval of protein structures, identifies the fibral core region, and computes mutation scores across amino acids.

---

## Files in this Repository

| File                 | Description                                                                                                                            |
| -------------------- | -------------------------------------------------------------------------------------------------------------------------------------- |
| `fibral_cores.ipynb` | Main Jupyter notebook performing the analysis: retrieves structures, identifies fibral cores, and computes mutation prediction scores. |
| `61YA.pdb`           | Example CSV formatted file with amino acid features, residue positions, and Envision AI mutation predictions.                          |

---

## Data Documentation (CSV / `61YA.pdb`)

This file contains amino acid level (residue-level) data for a specific amyloid protein. Each row represents one amino acid position in the protein sequence, along with biochemical features and predicted mutation effects.

| Column                           | Type   | Description                                                                |
| -------------------------------- | ------ | -------------------------------------------------------------------------- |
| `Unnamed: 0`                     | int    | Row index (for internal tracking)                                          |
| `X1`                             | int    | Unique residue index                                                       |
| `id2`                            | string | UniProt ID + mutation code                                                 |
| `AA1`                            | string | Wild-type amino acid                                                       |
| `AA2`                            | string | Mutant amino acid                                                          |
| `position`                       | int    | Residue position in sequence                                               |
| `Uniprot`                        | string | Protein UniProt accession number                                           |
| `WT_Mut`                         | string | Wild-type to mutant code                                                   |
| `Variant`                        | string | Mutation variant code                                                      |
| `AA1_polarity`                   | string | Polarity of wild-type amino acid                                           |
| `AA2_polarity`                   | string | Polarity of mutant amino acid                                              |
| `AA1_pI`                         | float  | Isoelectric point of wild-type residue                                     |
| `AA2_pI`                         | float  | Isoelectric point of mutant residue                                        |
| `deltaPI`                        | float  | Difference in pI (mutant – wild-type)                                      |
| `AA1_weight`                     | float  | Molecular weight of wild-type residue                                      |
| `AA2_weight`                     | float  | Molecular weight of mutant residue                                         |
| `deltaWeight`                    | float  | Difference in weight (mutant – wild-type)                                  |
| `AA1_volume`                     | float  | Residue volume of wild-type                                                |
| `AA2_volume`                     | float  | Residue volume of mutant                                                   |
| `deltavolume`                    | float  | Volume change (mutant – wild-type)                                         |
| `Grantham`                       | float  | Grantham distance between wild-type and mutant                             |
| `AA1_PSIC`                       | float  | PSIC score for wild-type amino acid                                        |
| `AA2_PSIC`                       | float  | PSIC score for mutant amino acid                                           |
| `delta_PSIC`                     | float  | Difference in PSIC scores                                                  |
| `solvent_accessibility`          | float  | Solvent-accessible surface area of residue                                 |
| `SecondaryStructure`             | string | Secondary structure label (e.g., alpha-helix, beta-sheet)                  |
| `phi_psi_angles`                 | string | Backbone dihedral angles of residue                                        |
| `delta_solvent_accessibility`    | float  | Change in solvent accessibility due to mutation                            |
| `b_factor`                       | float  | B-factor (atomic displacement parameter) from structure                    |
| `mut_msa_congruency`             | float  | Congruency score from multiple sequence alignment (mutation vs. wild-type) |
| `mut_mut_msa_congruency`         | float  | Congruency between multiple mutant sequences                               |
| `seq_ind_closest_mut`            | int    | Sequence index of closest mutation                                         |
| `evolutionary_coupling_avg`      | float  | Average evolutionary coupling score                                        |
| `evolutionary_coupling_prop`     | float  | Proportion of evolutionary coupling                                        |
| `evolutionary_coupling_avg_norm` | float  | Normalized average evolutionary coupling                                   |
| `Envision_predictions`           | float  | Predicted mutation effect score (0–1)                                      |

---
How the Fibral Core Is Found and Used

The notebook first takes a protein identifier (e.g., “2ZOQ”) and retrieves its structure data from an online database. It scans the text of the structure file for the annotated fibral core region, a continuous stretch of residues associated with amyloid fibril formation. The code extracts this residue number range (for example, positions 24–375) directly from the structure information and prints it as:

Fibral Core Range for structure 2ZOQ: 24 to 375


After identifying the fibral core, the notebook loads an Envision AI mutation dataset (e.g., 61YA.pdb) that contains amino acid–level biochemical and mutation features.
It uses the fibral core range to focus analysis specifically on that segment of the protein, averaging mutation effect scores across residues and amino acid types.

This allows the model to identify which mutations within the fibral core are most likely to influence aggregation and structural stability, providing insight into the mechanisms behind neurodegenerative diseases such as Alzheimer’s.

---

## Workflow (Notebook Summary)

1. **Protein Structure Retrieval**

   * The user specifies a protein (UniProt ID or name).
   * The notebook downloads its structure from an online database.

2. **Fibral Core Identification**

   * Parses the structure file to determine the fibral core range.
   * Example output:

     ```
     Fibral Core Range for structure 2ZOQ: 24 to 375
     ```

3. **Mutation Scoring**

   * Reads the Envision AI CSV file containing residue-level mutation predictions.
   * Aggregates scores across residues and amino acids to identify trends.
   * Outputs per-residue and per-amino-acid average scores:

     ```
     {'Q': 0.935, 'G': 0.958, 'A': 0.982, ...}
     ```

4. **Results**

   * Provides mutation effect summaries within the fibral core.
   * Supports visualization or further analysis of high impact residues.

---

## How to Use

1. Download or clone the repository.
2. Ensure the **Envision AI CSV file** is available locally.
3. Open `fibral_cores.ipynb` in Jupyter Notebook.
4. Specify the **protein_name** and **structure_name** at the beginning of the script.
5. Run the notebook. Results will print fibral core ranges and mutation scores.

---

## Tech Stack

* Python 3 (pandas, numpy, biopython)
* Jupyter Notebook
* CSV parsing and data aggregation


